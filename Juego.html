<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Juego Matem√°tico</title>

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#74ebd5,#9face6);
  text-align:center;
  margin:0;
}

/* ===== MEN√ö ===== */
#menu{
  margin-top:80px;
  background:white;
  display:inline-block;
  padding:30px 50px;
  border-radius:15px;
  box-shadow:0 10px 25px rgba(0,0,0,.2);
}

select,button,input{
  padding:10px;
  font-size:16px;
  margin:8px;
  border-radius:8px;
  border:none;
}

button{
  background:#4a90e2;
  color:white;
  cursor:pointer;
}

/* ===== JUEGO ===== */
#juego{display:none;}

.info{
  display:flex;
  justify-content:center;
  gap:30px;
  font-size:18px;
}

#zona{
  display:flex;
  justify-content:center;
  gap:25px;
  margin-top:20px;
}

/* ===== TABLERO ===== */
#tablero{
  display:grid;
  grid-template-columns:repeat(6,80px);
  gap:10px;
}

.carta{
  width:80px;
  height:80px;
  background-image:url("imagen_juego.png");
  background-size:cover;
  background-position:center;
  font-size:26px;
  color:transparent;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:10px;
  cursor:pointer;
}

.carta.abierta{
  background:none;
  background:#ecf0f1;
  color:black;
  font-weight:bold;
}

.carta.fija{
  background:none;
  background:#2ecc71;
  color:black;
  font-weight:bold;
  cursor:default;
}

/* ===== REGISTRO ===== */
#registro{
  width:230px;
  background:#fdeff9;
  padding:15px;
  border-radius:15px;
  box-shadow:0 8px 15px rgba(0,0,0,.2);
}

#registro ul{
  list-style:none;
  padding:0;
}

#registro li{
  background:#e0f7fa;
  margin:6px 0;
  padding:6px;
  border-radius:8px;
}

/* ===== ANIMACI√ìN GANAR ===== */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}

#ganador{
  background:white;
  padding:30px 40px;
  border-radius:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
  animation:zoom 0.6s ease;
}

@keyframes zoom{
  from{transform:scale(0);opacity:0}
  to{transform:scale(1);opacity:1}
}
</style>
</head>

<body>

<div id="overlay">
  <div id="ganador"></div>
</div>

<!-- ===== MEN√ö ===== -->
<div id="menu">
  <h1>üéÆ Juego Matem√°tico</h1>

  <input type="text" id="nombre" placeholder="Ingresa tu nombre">

  <p>Operaci√≥n</p>
  <select id="operacion">
    <option value="suma">Suma</option>
    <option value="multi">Multiplicaci√≥n</option>
  </select>

  <p>Dificultad</p>
  <select id="dificultad">
    <option value="5">F√°cil</option>
    <option value="10">Normal</option>
    <option value="20">Dif√≠cil</option>
  </select><br>

  <button onclick="empezar()">Empezar</button>

  <h3>üèÜ Ranking</h3>
  <ul id="ranking"></ul>
</div>

<!-- ===== JUEGO ===== -->
<div id="juego">
  <h2 id="titulo"></h2>

  <div class="info">
    <div>‚è±Ô∏è Tiempo: <span id="tiempo">03:00</span></div>
    <button onclick="volverMenu()">üòì Me rindo</button>
  </div>

  <div id="zona">
    <div id="tablero"></div>

    <div id="registro">
      <h3>üìù Operaciones</h3>
      <ul id="lista"></ul>
    </div>
  </div>

  <br>
  <input type="number" id="respuesta" placeholder="Respuesta">
  <button onclick="verificar()">Verificar</button>

  <p id="mensaje"></p>
</div>

<script>
let seleccionadas=[];
let operacion,max;
let cartasCorrectas=0;
let tiempo=180;
let reloj;
let inicio;

const tablero=document.getElementById("tablero");

function empezar(){
  let nombre=document.getElementById("nombre").value.trim();
  if(nombre==""){
    alert("Por favor ingresa tu nombre");
    return;
  }

  operacion=document.getElementById("operacion").value;
  max=Number(document.getElementById("dificultad").value);

  document.getElementById("menu").style.display="none";
  document.getElementById("juego").style.display="block";
  document.getElementById("lista").innerHTML="";
  document.getElementById("mensaje").textContent="";
  cartasCorrectas=0;

  document.getElementById("titulo").textContent =
    operacion=="suma" ? "‚ûï Suma" : "‚úñÔ∏è Multiplicaci√≥n";

  crearTablero();
  iniciarTiempo();
  inicio=Date.now();
}

function crearTablero(){
  tablero.innerHTML="";
  seleccionadas=[];

  for(let i=0;i<36;i++){
    let n=Math.floor(Math.random()*max)+1;
    let c=document.createElement("div");
    c.className="carta";
    c.textContent=n;
    c.dataset.valor=n;
    c.dataset.fija="no";

    c.onclick=function(){
      if(seleccionadas.length<2 && c.dataset.fija=="no"){
        c.classList.add("abierta");
        seleccionadas.push(c);
      }
    };
    tablero.appendChild(c);
  }
}

function verificar(){
  if(seleccionadas.length!=2) return;

  let a=Number(seleccionadas[0].dataset.valor);
  let b=Number(seleccionadas[1].dataset.valor);
  let correcta=operacion=="suma"?a+b:a*b;
  let resp=Number(document.getElementById("respuesta").value);

  if(resp==correcta){
    seleccionadas.forEach(c=>{
      c.classList.remove("abierta");
      c.classList.add("fija");
      c.dataset.fija="si";
      cartasCorrectas++;
    });

    let signo=operacion=="suma"?"+":"√ó";
    let li=document.createElement("li");
    li.textContent=`${a} ${signo} ${b} = ${correcta}`;
    document.getElementById("lista").appendChild(li);

    if(cartasCorrectas==36){
      clearInterval(reloj);
      let fin=Date.now();
      let total=Math.floor((fin-inicio)/1000);
      guardarRanking(total);
      mostrarGanador(total);
    }
  }else{
    seleccionadas.forEach(c=>c.classList.remove("abierta"));
  }

  seleccionadas=[];
  document.getElementById("respuesta").value="";
}

function iniciarTiempo(){
  tiempo=180;
  mostrarTiempo();

  reloj=setInterval(function(){
    tiempo--;
    mostrarTiempo();
    if(tiempo<=0){
      clearInterval(reloj);
      mostrarPerdedor();
      return;
    }
  },1000);
}

function mostrarTiempo(){
  let min=Math.floor(tiempo/60);
  let seg=tiempo%60;
  document.getElementById("tiempo").textContent=
    `${String(min).padStart(2,'0')}:${String(seg).padStart(2,'0')}`;
}

function guardarRanking(seg){
  let nombre=document.getElementById("nombre").value.trim();
  let datos=JSON.parse(localStorage.getItem("ranking")||"[]");
  datos.push({nombre,seg});
  datos.sort((a,b)=>a.seg-b.seg);
  datos=datos.slice(0,10);
  localStorage.setItem("ranking",JSON.stringify(datos));
  cargarRanking();
}

function cargarRanking(){
  let lista=document.getElementById("ranking");
  lista.innerHTML="";
  let datos=JSON.parse(localStorage.getItem("ranking")||"[]");
  datos.forEach((d,i)=>{
    let li=document.createElement("li");
    li.textContent=`${i+1}. ${d.nombre} - ${d.seg}s`;
    lista.appendChild(li);
  });
}

function mostrarPerdedor(){
  document.getElementById("overlay").style.display="flex";
  document.getElementById("ganador").innerHTML=
    `üò¢ <h2>¬°TIEMPO AGOTADO!</h2>
     <p>No lograste completar el juego a tiempo</p>
     <p>üí™ ¬°Int√©ntalo de nuevo, t√∫ puedes!</p>
     <button onclick="cerrarGanador()">Reintentar</button>`;
}

function mostrarPerdedor(){
  document.getElementById("overlay").style.display="flex";
  document.getElementById("ganador").innerHTML=
    `üò¢ <h2>¬°TIEMPO AGOTADO!</h2>
     <p>No lograste completar el juego a tiempo</p>
     <p>üí™ ¬°No te rindas, vuelve a intentarlo!</p>
     <button onclick="cerrarGanador()">Reintentar</button>`;
}

function mostrarGanador(seg){
  document.getElementById("overlay").style.display="flex";
  document.getElementById("ganador").innerHTML=
    `üéâ <h2>¬°FELICIDADES!</h2>
     <p>Has completado el juego en <b>${seg}</b> segundos</p>
     <p>üèÜ Revisa el ranking para ver tu posici√≥n</p>
     <button onclick="cerrarGanador()">Aceptar</button>`;
}

function cerrarGanador(){
  document.getElementById("overlay").style.display="none";
  volverMenu();
}

function volverMenu(){
  clearInterval(reloj);
  document.getElementById("juego").style.display="none";
  document.getElementById("menu").style.display="block";
}

cargarRanking();
</script>

</body>
</html>

